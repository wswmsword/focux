!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(r="undefined"!=typeof globalThis?globalThis:r||self,function(){var t=r.scaleView,o=r.scaleView=n();o.noConflict=function(){return r.scaleView=t,o}}())}(this,(function(){"use strict";function r(t,o){var a=new Map,c=new Map;if(!o&&t.length>1){var e=t.map((function(r){return r.wrap}));t.forEach((function(r){c.set(r.wrap.id,r.locs[0])}));var i=n(e).x;a=i}return t.forEach((function(t){var o=t.locs,e=t.subs,i=t.wrap,u=(e||[]).map((function(r){return r.wrap}));(e||[]).map((function(r){c.set(r.wrap.id,r.locs[0])}));var f=n(o.concat(u),i,u).x,l=r(e||[],!0),s=l.x,p=l.firstInWrap;a=new Map(Array.from(a).concat(Array.from(f)).concat(Array.from(s))),c=new Map(Array.from(c).concat(Array.from(p)))})),{x:a,firstInWrap:c}}function n(r,n,o){var a=[].concat(r);a.sort((function(r,n){return r.loc[0]-n.loc[0]}));var c=[].concat(r);c.sort((function(r,n){return r.loc[1]-n.loc[1]}));var e=new Map,i=-1/0,u=1/0,f=1/0,l=-1/0;return r.forEach((function(r){var s=r.loc,p=s[0],d=s[1],v=s[2],w=s[3],h=c.findIndex((function(n){return n.id===r.id})),y=a.findIndex((function(n){return n.id===r.id})),b=1/0,g=n,x=!1;c.slice(0,h).forEach((function(n){var o=function(r,n){var o=r[0],a=r[1],c=r[2],e=r[3],i=n[0],u=n[1],f=n[2],l=n[3],s=1/0;a>u&&(i-f>o+c?i-f-o-c<a-e-u-l&&(s=t(o+c,a-e,i-f,u+l)):i+f<o-c?o-c-i-f<a-e-u-l&&(s=t(o+c,a-e,i+f,u+l)):(s=Math.pow(a-e-u-l,2),u+l>a-e&&(s=-s)));return s}(r.loc,n.loc);o<b&&(x=!0,g=n,b=o)}));var A=1/0,m=n,M=!1;c.slice(h+1).forEach((function(n){var o=function(r,n){var o=r[0],a=r[1],c=r[2],e=r[3],i=n[0],u=n[1],f=n[2],l=n[3],s=1/0;a<u&&(i-f>o+c?i-f-o-c<u-l-a-e&&(s=t(o+c,a+e,i-f,u-l)):i+f<o-c?o-c-i-f<u-l-a-e&&(s=t(o-c,a+e,i+f,u-l)):(s=Math.pow(u-l-a-e,2),u-l<a+e&&(s=-s)));return s}(r.loc,n.loc);o<A&&(M=!0,m=n,A=o)}));var E=1/0,W=n,I=!1;a.slice(0,y).forEach((function(n){var o=function(r,n){var o=r[0],a=r[1],c=r[2],e=r[3],i=n[0],u=n[1],f=n[2],l=n[3],s=1/0;o>i&&(u-l>a+e?u-l-a-e<o-c-i-f&&(s=t(o-c,a+e,i+f,u-l)):u+l<a-e?a-e-u-l<o-c-i-f&&(s=t(o-c,a-e,i+f,u+l)):(s=Math.pow(o-c-i-f,2),i+f>o-c&&(s=-s)));return s}(r.loc,n.loc);o<E&&(I=!0,W=n,E=o)}));var j=1/0,O=n,S=!1;a.slice(y+1).forEach((function(n){var o=function(r,n){var o=r[0],a=r[1],c=r[2],e=r[3],i=n[0],u=n[1],f=n[2],l=n[3],s=1/0;i>o&&(u-l>a+e?u-l-a-e<i-f-o-c&&(s=t(o+c,a+e,i-f,u-l)):u+l<a-e?a-e-u-l<i-f-o-c&&(s=t(o+c,a-e,i-f,u+l)):(s=Math.pow(i-f-o-c,2),i-f<o+c&&(s=-s)));return s}(r.loc,n.loc);o<j&&(S=!0,O=n,j=o)})),e.set(r.id,{up:m,down:g,left:W,right:O,nextWrap:{up:!M,down:!x,right:!S,left:!I},nextSubWrap:{up:o.includes(m),down:o.includes(g),right:o.includes(O),left:o.includes(W)}}),i=d+w>i?d+w:i,u=d-w<u?d-w:u,f=p-w<f?p-v:f,l=p+w>l?p+v:l})),{x:e,t:i,b:u,l:f,r:l}}function t(r,n,t,o){var a=t-r,c=o-n;return a*a+c*c}function o(r){if(null!=r){var n=Array.isArray(r),t=n&&(Array.isArray(r[0])?"number"==typeof r[0][0]:null!=r[0].loc),a=!n,c=!t&&!a,e=null;if(t)e=[{locs:r.map((function(r){return Array.isArray(r)?{id:r,loc:r}:r}))}];else if(a){var i=r.wrap,u=r.subs;e=[{locs:o(r.locs)[0].locs}],null!=u&&Object.assign(e[0],{subs:o(r.subs)}),null!=i&&Object.assign(e[0],{wrap:Array.isArray(i)?{loc:i,id:i}:i})}else c&&(e=r.map((function(r){var n=r.locs,t=r.wrap,a=r.subs,c={locs:o(n)[0].locs,wrap:Array.isArray(t)?{loc:t,id:t}:t};return a&&Object.assign(c,{subs:o(a)}),c})));return e}}return function(n){var t=r(o(n));return function(r,n){var t=new Map;return r.forEach((function(r,n){var a=r.up,c=r.right,e=r.down,i=r.left,u=r.nextWrap,f=r.nextSubWrap,l=u.up,s=u.right,p=u.down,d=u.left,v=f.up,w=f.right,h=f.down,y=f.left,b=o("up",a,l,v),g=o("right",c,s,w),x=o("down",e,p,h),A=o("left",i,d,y);t.set(n,{up:b,right:g,down:x,left:A})})),t;function o(t,o,a,c){var e=o;if(o&&a){var i=r.get(o.id),u=i.nextSubWrap;e=i[t],u[t]&&(e=n.get(i[t].id))}else c&&(e=n.get(o.id));return e}}(t.x,t.firstInWrap)}}));
//# sourceMappingURL=naviix.umd.min.js.map
